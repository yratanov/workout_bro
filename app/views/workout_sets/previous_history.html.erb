<%= turbo_frame_tag "previous_history_modal" do %>
  <div
    data-controller="modal"
    data-modal-auto-open-value="true"
    data-modal-turbo-frame-value="previous_history_modal"
  >
    <%= render ModalComponent.new(title: t(".title", exercise: @workout_set.exercise.name), size: "md") do %>
      <div class="p-6 overflow-y-auto min-h-0 flex-1">
        <% if @previous_set %>
          <div class="mb-4 text-slate-300">
            <%= t(".date") %>:
            <span class="font-semibold"><%= @previous_set.created_at.strftime("%d %b %Y") %></span>
          </div>

          <div class="space-y-3">
            <div class="bg-slate-700 rounded p-3">
              <div class="flex flex-wrap gap-2">
                <% @previous_set.workout_reps.each_with_index do |rep, i| %>
                  <span class="text-sm bg-slate-600 px-2 py-1 rounded">
                    <span class="text-slate-400"><%= i + 1 %>.</span>
                    <%= rep.reps %>
                    <% if rep.weight %>
                      x
                      <%= rep.weight %>kg
                    <% end %>
                    <% if rep.band.present? %>
                      (<%= rep.band %>)
                    <% end %>
                  </span>
                <% end %>
              </div>
              <% if @previous_set.workout_reps.empty? %>
                <p class="text-slate-400"><%= t(".no_reps") %></p>
              <% end %>
            </div>
          </div>
        <% else %>
          <p class="text-slate-400"><%= t(".no_previous") %></p>
        <% end %>
      </div>

      <div class="p-6 border-t border-slate-700 flex justify-end flex-shrink-0">
        <button
          type="button"
          data-action="click->modal#close"
          class="px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded"
        >
          <%= t(".close") %>
        </button>
      </div>
    <% end %>
  </div>
<% end %>
