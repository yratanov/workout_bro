<%= turbo_frame_tag "workout_modal" do %>
  <div data-controller="modal" data-modal-auto-open-value="true" data-modal-turbo-frame-value="workout_modal">
    <%= render ModalComponent.new(title: modal_title(@workout), size: "md") do %>
      <div class="p-6 overflow-y-auto min-h-0 flex-1">
        <div class="mb-4 text-slate-300">
          <%= t(".duration") %>: <span class="font-semibold"><%= seconds_to_human(@workout.time_in_seconds) %></span>
        </div>

        <% if @workout.strength? %>
          <div class="space-y-3">
            <% @workout.workout_sets.each do |set| %>
              <div class="bg-slate-700 rounded p-3">
                <div class="font-medium mb-2 flex items-center gap-2">
                  <% if set.exercise.muscle.present? %>
                    <span class="text-slate-400"><%= muscle_icon(set.exercise.muscle, size: "w-5 h-5") %></span>
                  <% end %>
                  <%= set.exercise.name %>
                </div>
                <div class="flex flex-wrap gap-2">
                  <% set.workout_reps.each do |rep| %>
                    <span class="text-sm bg-slate-600 px-2 py-1 rounded">
                      <%= rep.reps %> x <%= rep.weight %>kg
                      <% if rep.band.present? %>
                        (<%= rep.band %>)
                      <% end %>
                    </span>
                  <% end %>
                </div>
              </div>
            <% end %>
            <% if @workout.workout_sets.empty? %>
              <p class="text-slate-400"><%= t(".no_exercises") %></p>
            <% end %>
          </div>
        <% else %>
          <div class="space-y-4">
            <div class="grid grid-cols-2 gap-4">
              <div class="bg-slate-700 rounded p-4">
                <p class="text-slate-400 text-sm"><%= t(".distance") %></p>
                <p class="text-2xl font-semibold"><%= (@workout.distance.to_f / 1000).round(2) %> km</p>
              </div>
              <div class="bg-slate-700 rounded p-4">
                <p class="text-slate-400 text-sm"><%= t(".avg_pace") %></p>
                <p class="text-2xl font-semibold"><%= run_pace(@workout) %></p>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <div class="p-6 border-t border-slate-700 flex justify-between flex-shrink-0">
        <button type="button" data-action="click->modal#close" class="px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded">
          <%= t(".close") %>
        </button>
        <%= button_to workout_path(@workout),
          method: :delete,
          data: { turbo_confirm: t(".delete_confirm"), turbo_frame: "_top" },
          class: "px-4 py-2 bg-red-600 hover:bg-red-500 rounded text-white cursor-pointer" do %>
          <%= t(".delete") %>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>
