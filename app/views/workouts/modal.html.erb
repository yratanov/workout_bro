<%= turbo_frame_tag "workout_modal" do %>
  <div
    data-controller="modal"
    data-modal-auto-open-value="true"
    data-modal-turbo-frame-value="workout_modal"
  >
    <%= render ModalComponent.new(title: modal_title(@workout), size: "md") do %>
      <div class="p-6 overflow-y-auto min-h-0 flex-1">
        <% if @workout.strength? %>
          <!-- Stats Grid -->
          <div class="grid grid-cols-3 gap-3 mb-4">
            <div class="bg-slate-700 rounded-lg p-3 text-center">
              <div class="text-slate-400 text-xs mb-1"><%= t(".total_volume") %></div>
              <div class="text-lg font-bold text-white">
                <%= format_volume(@summary.total_volume) %>
              </div>
            </div>
            <div class="bg-slate-700 rounded-lg p-3 text-center">
              <div class="text-slate-400 text-xs mb-1"><%= t(".sets") %></div>
              <div class="text-lg font-bold text-white"><%= @summary.total_sets %></div>
            </div>
            <div class="bg-slate-700 rounded-lg p-3 text-center">
              <div class="text-slate-400 text-xs mb-1"><%= t(".duration") %></div>
              <div class="text-lg font-bold text-white">
                <%= seconds_to_human(@summary.duration || 0) %>
              </div>
            </div>
          </div>
          <!-- Muscles Worked -->
          <% if @summary.muscles_worked.any? %>
            <div class="mb-4">
              <div class="text-slate-400 text-xs mb-2"><%= t(".muscles_worked") %></div>
              <div class="flex flex-wrap gap-2">
                <% @summary.muscles_worked.each do |muscle| %>
                  <div class=" flex items-center gap-1.5 bg-slate-700 rounded-full px-2.5 py-1 ">
                    <%= muscle_icon(muscle, size: "w-4 h-4") %>
                    <span class="text-white text-sm"><%= muscle.human_name %></span>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
          <!-- Comparison (if available) -->
          <% if @summary.previous_workout && @summary.comparison %>
            <div class="bg-slate-700 rounded-lg p-3 mb-4">
              <div class="flex items-center justify-between">
                <span class="text-slate-400 text-sm"><%= t(".vs_last") %></span>
                <div class="flex items-center gap-2">
                  <span class="<%= comparison_class(@summary.comparison.volume_diff) %>">
                    <%= icon comparison_arrow(@summary.comparison.volume_diff), size: "w-4 h-4" %>
                  </span>
                  <span
                    class="
                      <%= comparison_class(@summary.comparison.volume_diff) %> font-semibold
                    "
                  >
                    <% if @summary.comparison.volume_diff >= 0 %>+<% end %><%= format_volume(@summary.comparison.volume_diff) %>
                  </span>
                  <span class="text-slate-500 text-sm">
                    (<% if @summary.comparison.volume_diff_percent >= 0 %>+<% end %><%= @summary.comparison.volume_diff_percent %>%)
                  </span>
                </div>
              </div>
            </div>
          <% end %>

          <% if @workout.workout_sets.empty? %>
            <p class="text-slate-400 text-center"><%= t(".no_exercises") %></p>
          <% end %>
        <% else %>
          <!-- Run Workout Stats -->
          <div class="grid grid-cols-3 gap-3 mb-4">
            <div class="bg-slate-700 rounded-lg p-3 text-center">
              <div class="text-slate-400 text-xs mb-1"><%= t(".distance") %></div>
              <div class="text-lg font-bold text-white">
                <%= (@summary.distance.to_f / 1000).round(2) %>
                km
              </div>
            </div>
            <div class="bg-slate-700 rounded-lg p-3 text-center">
              <div class="text-slate-400 text-xs mb-1"><%= t(".duration") %></div>
              <div class="text-lg font-bold text-white">
                <%= seconds_to_human(@summary.duration || 0) %>
              </div>
            </div>
            <div class="bg-slate-700 rounded-lg p-3 text-center">
              <div class="text-slate-400 text-xs mb-1"><%= t(".pace") %></div>
              <div class="text-lg font-bold text-white">
                <%= format_pace(@summary.pace) %>
              </div>
            </div>
          </div>
          <!-- Run Comparison -->
          <% if @summary.previous_workout && @summary.comparison&.pace_diff %>
            <div class="bg-slate-700 rounded-lg p-3 mb-4">
              <div class="flex items-center justify-between">
                <span class="text-slate-400 text-sm"><%= t(".vs_last") %></span>
                <div class="flex items-center gap-2">
                  <% pace_improved = @summary.comparison.pace_diff > 0 %>
                  <span
                    class="
                      <%= pace_improved ? 'text-green-400' : 'text-red-400' %> font-semibold
                    "
                  >
                    <%= format_pace_diff(@summary.comparison.pace_diff) %>
                    <%= pace_improved ? t(".faster") : t(".slower") %>
                  </span>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>

      <div class="p-6 border-t border-slate-700 flex justify-between flex-shrink-0">
        <div class="flex gap-2">
          <%= button t(".close"), style: "outlined", data: { action: "click->modal#close" } %>
          <%= button t(".view_details"),
          type: "link",
          style: "primary",
          route: workout_path(@workout),
          data: {
            turbo_frame: "_top",
          } %>
        </div>
        <%= button t(".delete"),
        style: "danger",
        method: :delete,
        route: workout_path(@workout),
        data: {
          turbo_confirm: t(".delete_confirm"),
          turbo_frame: "_top",
        } %>
      </div>
    <% end %>
  </div>
<% end %>
