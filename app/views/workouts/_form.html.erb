<%= form_with(model: workout, class: "contents") do |form| %>
  <div class="mb-4" data-controller="element-destroyer workout-type-switcher">
    <% if workout.errors.any? %>
      <div
        id="error_explanation"
        class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-md mt-3"
      >
        <h2><%= pluralize(workout.errors.count, "error") %>
          prohibited this workout from being saved:</h2>

        <ul class="list-disc ml-6">
          <% workout.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="mb-4">
      <div>
        <%= form.label :workout_type, class: "font-medium" %>
      </div>
      <%= form.select :workout_type,
                  Workout.workout_types.keys.map { |type| [type.humanize, type] },
                  {},
                  {
                    data: {
                      action: "change->workout-type-switcher#switch",
                    },
                    class: "border border-slate-300 px-3.5 py-2 rounded",
                  } %>

    </div>

    <div class="mb-4 hidden" data-workout-type-switcher-target="runToggle">
      <%= form.label :started_at, class: "font-medium" %>
      <%= form.date_field :started_at,
                      class: [
                        "block shadow-sm rounded-md border px-3 py-2 mt-2 w-full",
                        {
                          "border-gray-400 focus:outline-blue-600":
                            workout.errors[:started_at].none?,
                          "border-red-400 focus:outline-red-600":
                            workout.errors[:started_at].any?,
                        },
                      ] %>

    </div>
    <div class="mb-4 hidden" data-workout-type-switcher-target="runToggle">
      <%= form.label :distance, class: "font-medium" %>
      <%= form.text_field :distance,
                      class: [
                        "block shadow-sm rounded-md border px-3 py-2 mt-2 w-full",
                        {
                          "border-gray-400 focus:outline-blue-600":
                            workout.errors[:distance].none?,
                          "border-red-400 focus:outline-red-600":
                            workout.errors[:distance].any?,
                        },
                      ] %>

    </div>
    <div class="mb-4 hidden" data-workout-type-switcher-target="runToggle">
      <%= form.label :time_in_seconds, class: "font-medium" %>
      <%= form.text_field :time_in_seconds,
                      class: [
                        "block shadow-sm rounded-md border px-3 py-2 mt-2 w-full",
                        {
                          "border-gray-400 focus:outline-blue-600":
                            workout.errors[:time_in_seconds].none?,
                          "border-red-400 focus:outline-red-600":
                            workout.errors[:time_in_seconds].any?,
                        },
                      ] %>

    </div>
    <div
      data-element-destroyer-target="destroyable"
      data-workout-type-switcher-target="strengthToggle"
      data-controller="routine-switcher"
    >
      <div class="mb-4">
        <div>
          <%= form.label :workout_routine, class: "font-medium" %>
        </div>
        <%= select_tag "workout[workout_routine_day]",
        options_from_collection_for_select(
          WorkoutRoutine.order(:name).to_a,
          "id",
          "name",
          workout.workout_routine&.id,
        ),
        data: {
          action: "change->routine-switcher#switch",
        },
        class: "border border-slate-300 px-3.5 py-2 rounded" %>
      </div>
      <div class="mb-4">
        <div>
          <%= form.label :workout_routine_day, class: "font-medium" %>
        </div>
        <%= turbo_frame_tag 'workout_routine_day_id' do %>
          <%= render partial: "workout_routine_days/select",
          locals: {
            workout_routine_days: workout.workout_routine&.workout_routine_days,
          } %>
        <% end %>
      </div>
    </div>
    <div
      data-element-destroyer-target="destroyable"
      data-workout-type-switcher-target="strengthToggle"
    >
      or
    </div>
    <div data-workout-type-switcher-target="strengthToggle">
      <%= button "switch to custom routine",
      type: "button",
      style: "link",
      data: {
        action: "click->element-destroyer#destroy",
      } %>
    </div>
  </div>

  <div class="flex gap-4 flex-wrap lg:flex-nowrap">
    <%= button text: "Start", type: "submit", style: "primary" %>
    <%= button "Back to workouts", route: workouts_path, style: "outlined", type: "link" %>
  </div>
<% end %>
