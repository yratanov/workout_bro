<div>
  <% persisted_reps = workout_set.workout_reps.filter(&:persisted?) %>

  <%# Reps as horizontal pills %>
  <div class="flex flex-wrap gap-2 mb-4">
    <% persisted_reps.each_with_index do |rep, i| %>
      <div
        class="
          group flex items-center gap-1 bg-slate-600 rounded-full pl-3 pr-1 py-1
        "
      >
        <span class="text-slate-400 text-sm"><%= i + 1 %>.</span>
        <span class="font-medium"><%= rep.reps %></span>
        <% if rep.weight %>
          <span class="text-slate-300">Ã—
            <%= rep.weight %>kg</span>
        <% end %>
        <% if rep.band %>
          <span class="text-xs text-slate-400 ml-1"><%= rep.band.humanize %></span>
        <% end %>
        <%= button route: workout_rep_path(rep), method: :delete, type: 'button', style: "link_hover_danger", data: { turbo_confirm: t("shared.confirmations.delete_confirm") } do %>
          <span class="opacity-0 group-hover:opacity-100 transition-opacity"><%= icon "xmark" %></span>
        <% end %>
      </div>
    <% end %>
    <% if persisted_reps.empty? && !workout_set.ended? %>
      <span class="text-slate-500 text-sm italic"><%= t("workout_reps.list_with_form.add_first_rep") %></span>
    <% end %>
  </div>

  <%# Form for adding reps %>
  <% unless workout_set.ended? %>
    <div class="flex items-center gap-3 pt-3 border-t border-slate-600">
      <div class="flex items-center gap-1 text-slate-400 text-sm tabular-nums">
        <%= icon "stopwatch" %>
        <div
          data-controller="timer"
          data-timer-show-hours-value="false"
          data-timer-date-value="<%= (persisted_reps.last&.updated_at || DateTime.now).iso8601 %>"
        ></div>
      </div>
      <div class="flex-1">
        <%= render "workout_reps/form",
        workout_rep: workout_set.workout_reps.new(workout_set.default_rep_values) %>
      </div>
    </div>
  <% end %>
</div>
